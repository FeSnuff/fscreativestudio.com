<style>
.login-view { display: flex; justify-content: center; align-items: center; min-height: 100vh; padding: 20px; }
.login-box { background: #fff; padding: 40px; border-radius: 15px; width: 100%; max-width: 400px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); }
.login-title { text-align: center; font-size: 28px; margin-bottom: 30px; color: #333; }
.input-group { margin-bottom: 20px; }
.input-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #333; }
.input-group input { width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; transition: border-color 0.3s; }
.input-group input:focus { outline: none; border-color: #667eea; }
.password-wrapper { position: relative; display: flex; align-items: center; }
.password-wrapper input { flex: 1; padding-right: 45px; }
.toggle-password { 
    position: absolute; 
    right: 12px; 
    cursor: pointer; 
    user-select: none;
    color: #999;
    font-size: 18px;
    transition: color 0.3s;
    padding: 5px;
}
.toggle-password:hover { color: #667eea; }
.btn-login { width: 100%; padding: 14px; border: none; border-radius: 8px; background: linear-gradient(135deg, #667eea, #764ba2); color: #fff; font-size: 18px; font-weight: 600; cursor: pointer; transition: transform 0.2s; }
.btn-login:hover { transform: translateY(-2px); }
.btn-login:disabled { opacity: 0.6; cursor: not-allowed; }
.error-msg { color: #dc3545; font-size: 14px; margin-top: 10px; text-align: center; display: none; }
</style>

<div class="login-view">
    <div class="login-box">
        <h2 class="login-title">üåÑ Iniciar Sesi√≥n</h2>
        <form id="loginForm">
            <div class="input-group">
                <label>Usuario</label>
                <input type="text" id="username" required autocomplete="username">
            </div>
            <div class="input-group">
                <label>Contrase√±a</label>
                <div class="password-wrapper">
                    <input type="password" id="password" required autocomplete="current-password">
                    <span class="toggle-password" onclick="togglePassword()" title="Mostrar/Ocultar contrase√±a">
                        <svg id="eyeIcon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                            <circle cx="12" cy="12" r="3"></circle>
                        </svg>
                    </span>
                </div>
            </div>
            <button type="submit" class="btn-login">Entrar</button>
            <div class="error-msg" id="errorMsg"></div>
        </form>
    </div>
</div>

<script>
function togglePassword() {
    const passwordInput = document.getElementById('password');
    const eyeIcon = document.getElementById('eyeIcon');
    
    if (passwordInput.type === 'password') {
        passwordInput.type = 'text';
        // Change to eye-off icon
        eyeIcon.innerHTML = '<path d="M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"></path><line x1="1" y1="1" x2="23" y2="23"></line>';
    } else {
        passwordInput.type = 'password';
        // Change to eye icon
        eyeIcon.innerHTML = '<path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path><circle cx="12" cy="12" r="3"></circle>';
    }
}

document.getElementById('loginForm').addEventListener('submit', async (e) => {
    e.preventDefault();
    
    console.log('=== INICIANDO PROCESO DE LOGIN ===');
    
    const user = document.getElementById('username').value;
    const pass = document.getElementById('password').value;
    const btn = e.target.querySelector('.btn-login');
    const errorMsg = document.getElementById('errorMsg');
    
    console.log('Usuario ingresado:', user);
    console.log('Contrase√±a ingresada:', pass ? '***' + pass.slice(-2) : 'vac√≠a');
    
    btn.disabled = true;
    btn.textContent = 'Verificando...';
    errorMsg.style.display = 'none';
    
    try {
        console.log('Llamando a funci√≥n login()...');
        await login(user, pass);
        console.log('‚úÖ Login exitoso');
    } catch (error) {
        console.error('‚ùå Error en login:', error);
        console.error('Mensaje de error:', error.message);
        console.error('Stack trace:', error.stack);
        errorMsg.textContent = error.message || 'Error al iniciar sesi√≥n';
        errorMsg.style.display = 'block';
        btn.disabled = false;
        btn.textContent = 'Entrar';
    }
});
</script>
